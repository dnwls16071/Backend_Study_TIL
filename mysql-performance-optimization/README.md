### ✅ 백엔드 면접에서 물어보는 DB 성능 최적화 경험

* 크게 3가지 요인 때문에 성능 저하를 경험하게 된다. 
  * 동시 사용자 수의 증가
  * 데이터 양의 증가
  * 비효율적인 SQL문 작성

### ✅ DB 성능 개선할 때, SQL 튜닝을 먼저 하는 이유

* DB 성능을 개선하는 방법은 다양하다.
  * SQL 튜닝
  * 캐싱 서버 활용(Redis)
  * 레플리케이션(Master/Slave 구조)
  * 샤딩
  * 스케일업(CPU, Memory, SSD 등 하드웨어 업그레이드)

### ✅ 많은 성능 개선 방법 중에서 왜 SQL 튜닝을 먼저 고려해야하는지?

* 위에 제시된 방법들 중에서 SQL 튜닝을 제외한 나머지 방식들은 추가적인 시스템을 구축해야 한다.
* 따라서, 금전적, 시간적 비용이 추가적으로 발생한다.
* 조금 더 복잡해진 시스템 구조로 인해 관리 비용이 늘어난다. 그에 비해 SQL 튜닝은 기존의 시스템 변경 없이 성능을 개선할 수 있다.
* 근본적인 문제를 해결하는 방법이 SQL 튜닝일 가능성이 높다. SQL 자체가 비효율적으로 작성되었다면 아무리 시스템적으로 성능을 개선한다고 하더라도 한계가 있다.
* 하지만 SQL 튜닝을 통해서 기본적으로 성능을 향상시킨다면 시스템적인 성능 개선이 필요없거나 훨씬 간단한 개선으로도 큰 성능 개선 효과를 얻을 수 있다.

### ✅ 성능 개선을 위한 MySQL 구조 파악 / SQL 튜닝의 핵심

<img src="/image/img1.webp">

1. 클라이언트가 DB에 SQL 요청을 보낸다.
2. MySQL 엔진에서 옵티마이저가 SQL문을 분석한 뒤 빠르고 효율적으로 데이터를 가져올 수 있는 계획을 세운다. 어떤 순서로 테이블에 접근할지, 인덱스를 사용할지, 어떤 인덱스를 사용할지 등을 결정한다.
* 옵티마이저가 세운 계획은 완벽하지 않다. 따라서 SQL 튜닝이 필요하다.
3. 옵티마이저가 세운 계획을 바탕으로 스토리지 엔진에서 데이터를 가져온다.
* DB 성능에 문제가 생기는 대부분의 원인은 스토리지 엔진으로부터 데이터를 가져올 때 발생한다.
* 데이터를 찾기가 어려워서 오래 걸리거나 가져올 데이터가 너무 많아서 오래 걸린다.
* SQL 튜닝의 핵심은 스토리지 엔진으로부터 되도록이면 데이터를 찾기 쉽게 바꾸고, 적은 데이터를 가져오도록 바꾸는 것을 말한다.
4. MySQL 엔진에서 정렬, 필터링 등 마지막 처리를 한 뒤에 클라이언트에게 SQL 결과를 응답한다.

> SQL 튜닝에 있어서 핵심은 2가지이다.
>
> 1. 스토리지 엔진에서 데이터를 찾기 쉽게 바꾸기
> 2. 스토리지 엔진으로부터 가져오는 데이터의 양 줄이기

* 여러 가지 방법이 있겠지만 가장 많이 활용되는 방법은 바로 인덱스 활용이다.
* 단순히 인덱스만 적용한다고 무조건 해결되는 것은 아니다.

### ✅ 인덱스(Index)